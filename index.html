<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SMART ATTENDANCE TRACKER</title>
  <style>
    :root{
      --accent:#3b82f6;
      --danger:#ef4444;
      --muted:#d4d4d4;
    }
    body{
      margin:0;
      background:linear-gradient(140deg,rgba(10,10,10,0.9),rgba(35,35,35,0.9));
      backdrop-filter:blur(6px);
      -webkit-backdrop-filter:blur(6px);
      font-family:Inter,Arial;
      color:white;
    }
    .container{max-width:980px;margin:28px auto;padding:18px}
    header h1{ color:white;text-shadow:0 0 10px rgba(0,0,0,0.6); }
    header .muted{ color:#ccc; }

    .card, .login-wrap{
      background:rgba(255,255,255,0.07);
      border-radius:16px;
      padding:16px;
      box-shadow:0 8px 32px rgba(0,0,0,0.45);
      border:1px solid rgba(255,255,255,0.15);
      backdrop-filter:blur(12px);
      -webkit-backdrop-filter:blur(12px);
      animation:fadeIn 0.8s ease;
    }
    input[type=text], input[type=password], input[type=date], select{
      width:100%;
      padding:10px;
      margin-bottom:10px;
      border-radius:10px;
      border:1px solid rgba(255,255,255,0.25);
      background:rgba(255,255,255,0.1);
      color:white;
      backdrop-filter:blur(8px);
    }
    input::placeholder{ color:#ddd; }
    button{
      padding:10px 14px;
      border-radius:10px;
      border:1px solid rgba(255,255,255,0.25);
      background:rgba(59,130,246,0.4);
      color:white;
      cursor:pointer;
      transition:.3s;
      font-weight:600;
      position:relative;
      overflow:hidden;
      margin-right:5px;
    }
    button:hover{ background:rgba(59,130,246,0.65); }
    button:active::after{
      content:"";
      position:absolute;
      width:10px;height:10px;
      background:white;
      opacity:0.9;
      border-radius:50%;
      left:50%;top:50%;
      transform:translate(-50%,-50%) scale(0);
      animation:ripple 0.6s linear;
    }
    @keyframes ripple{ to{ transform:translate(-50%,-50%) scale(25); opacity:0; } }
    .logout{ background:rgba(255,255,255,0.25); color:#fff; }

    .tab-buttons{ margin-bottom:15px; }
    .tab-buttons button{ margin-right:8px; }
    .tab-content{ display:none; margin-top:15px; }
    .tab-content.active{ display:block; }

    table{ width:100%; border-collapse:collapse; background:rgba(255,255,255,0.08); border-radius:12px; overflow:hidden; backdrop-filter:blur(10px); animation:fadeIn 0.8s ease;}
    th,td{ padding:8px; border-bottom:1px solid rgba(255,255,255,0.15); color:white; font-weight:500; background:rgba(255,255,255,0.03);}
    th{ font-weight:700; }
    tr:hover{ background:rgba(255,255,255,0.15); transition:0.25s; }
    .actions button{ padding:6px 8px; background:rgba(255,255,255,0.15); border-radius:8px; color:white; }
    .actions button:hover{ background:rgba(255,255,255,0.25); }

    .report-bar{ height:18px; background:rgba(255,255,255,0.12); border-radius:999px; overflow:hidden; border:1px solid rgba(255,255,255,0.2); backdrop-filter:blur(10px); margin-top:10px; }
    .report-bar .fill{ height:100%; background:rgba(59,130,246,0.9); width:0; animation:slideFill 1s ease forwards; }
    @keyframes fadeIn{ from{opacity:0;transform:translateY(15px);} to{opacity:1;transform:translateY(0);} }
    @keyframes slideFill{ from{width:0;} to{width:var(--w);} }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>SMART ATTENDANCE TRACKER</h1>
      <div class="muted">Client-side · Local Storage</div>
    </header>

    <!-- LOGIN -->
    <section id="loginSection" class="card login-wrap">
      <h2 style="margin-top:0;color:white">Admin Login</h2>
      <div class="small">Use default credentials</div>

      <label>Username</label>
      <input id="username" type="text" placeholder="admin">
      <label>Password</label>
      <input id="password" type="password" placeholder="password123">

      <div style="display:flex;gap:10px;margin-top:10px">
        <button id="loginBtn">Login</button>
        <button id="clearDataBtn" class="logout">Clear All</button>
      </div>
    </section>

    <!-- DASHBOARD -->
    <section id="dashboardSection" style="display:none">
      <div class="tab-buttons">
        <button data-tab="addStudentTab">Add Student</button>
        <button data-tab="attendanceTab">Attendance</button>
        <button data-tab="reportTab">Percentage Report</button>
      </div>

      <div id="addStudentTab" class="tab-content">
        <div class="card">
          <h3>Add Student</h3>
          <label>Roll</label>
          <input id="sRoll">
          <label>Name</label>
          <input id="sName">
          <label>Batch</label>
          <input id="sBatch">
          <button id="addStudentBtn">Add</button>
          <button id="importSample" class="logout">Sample</button>
        </div>
      </div>

      <div id="attendanceTab" class="tab-content">
        <div class="card">
          <h3>Student List</h3>
          <table id="studentTable">
            <thead><tr><th>Roll</th><th>Name</th><th>Batch</th><th>Actions</th></tr></thead>
            <tbody></tbody>
          </table>
        </div>
      </div>

      <div id="reportTab" class="tab-content">
        <div class="card">
          <h3>Attendance Report</h3>
          <input id="reportRoll" placeholder="Enter roll">
          <button id="genReportBtn">Generate</button>
          <div id="reportResult" style="margin-top:10px"></div>
        </div>
      </div>
    </section>
  </div>

<script>
const KEY_STUDENTS='students';
const KEY_ATT='attendanceRecords';
const KEY_ADMIN='adminCredentials';

function initAdmin(){
  if(!localStorage.getItem(KEY_ADMIN)) localStorage.setItem(KEY_ADMIN,JSON.stringify({username:'admin',password:'password123'}));
  if(!localStorage.getItem(KEY_STUDENTS)) localStorage.setItem(KEY_STUDENTS,JSON.stringify([]));
  if(!localStorage.getItem(KEY_ATT)) localStorage.setItem(KEY_ATT,JSON.stringify({}));
}

function handleLogin(){
  const u=username.value;
  const p=password.value;
  const c=JSON.parse(localStorage.getItem(KEY_ADMIN));
  if(u===c.username && p===c.password){
    sessionStorage.setItem('isAuth','1');
    showDashboard();
  } else alert("Invalid");
}

function getStudents(){ return JSON.parse(localStorage.getItem(KEY_STUDENTS)); }
function saveStudents(a){ localStorage.setItem(KEY_STUDENTS,JSON.stringify(a)); }

function addStudent(){
  const r=sRoll.value.trim(), n=sName.value.trim(), b=sBatch.value.trim();
  if(!r||!n) return alert("Roll & Name required");
  const s=getStudents();
  if(s.find(x=>x.roll==r)) return alert("Roll exists");
  s.push({roll:r,name:n,batch:b});
  saveStudents(s);
  renderStudentList();
}

function renderStudentList(){
  const tb=document.querySelector('#studentTable tbody');
  tb.innerHTML="";
  const s=getStudents();
  const att=JSON.parse(localStorage.getItem(KEY_ATT)||"{}");

  s.forEach(st=>{
    const tr=document.createElement("tr");
    tr.innerHTML=`<td>${st.roll}</td><td>${st.name}</td><td>${st.batch||""}</td><td class="actions"></td>`;
    const act=tr.querySelector(".actions");
    const p=document.createElement("button"); p.textContent="P";
    const a=document.createElement("button"); a.textContent="A";
    const v=document.createElement("button"); v.textContent="Report";
    p.onclick=()=>markAttendance(st.roll,'P');
    a.onclick=()=>markAttendance(st.roll,'A');
    v.onclick=()=>generateReport(st.roll);
    act.append(p,a,v);
    tb.append(tr);
  });
}

function markAttendance(roll,status){
  const date=new Date().toISOString().split("T")[0];
  const r=JSON.parse(localStorage.getItem(KEY_ATT)||"{}");
  if(!r[roll]) r[roll]={};
  r[roll][date]=status;
  localStorage.setItem(KEY_ATT,JSON.stringify(r));
  renderStudentList();
}

function generateReport(roll){
  const div=reportResult;
  div.innerHTML="";
  const s=getStudents().find(x=>x.roll==roll);
  if(!s) return alert("Not found");
  const r=JSON.parse(localStorage.getItem(KEY_ATT)||"{}")[roll]||{};
  const dates=Object.keys(r).sort();
  let present=0; dates.forEach(d=>{ if(r[d]==='P') present++; });
  const total=dates.length;
  const per=total?Math.round(present/total*100):0;
  div.innerHTML=`<h4>${s.name} (${s.roll}) — ${present}/${total}</h4>
  <div class="report-bar"><div class="fill" style="--w:${per}%;width:${per}%"></div></div>`;
}

function showDashboard(){
  loginSection.style.display='none';
  dashboardSection.style.display='block';
  document.querySelectorAll('.tab-content').forEach(t=>t.classList.remove('active'));
  document.getElementById('addStudentTab').classList.add('active');
  renderStudentList();
}

document.addEventListener("DOMContentLoaded",()=>{
  initAdmin();
  if(sessionStorage.getItem('isAuth')) showDashboard();
  loginBtn.onclick=handleLogin;
  addStudentBtn.onclick=addStudent;
  importSample.onclick=()=>{
    saveStudents([{roll:'101',name:'Asha',batch:'A'},{roll:'102',name:'Ravi',batch:'A'}]);
    localStorage.setItem(KEY_ATT,JSON.stringify({}));
    renderStudentList();
  };
  genReportBtn.onclick=()=>generateReport(reportRoll.value);
  clearDataBtn.onclick=()=>{localStorage.clear();location.reload();}

  // TAB BUTTONS
  document.querySelectorAll('.tab-buttons button').forEach(btn=>{
    btn.addEventListener('click',()=>{
      document.querySelectorAll('.tab-content').forEach(t=>t.classList.remove('active'));
      document.getElementById(btn.dataset.tab).classList.add('active');
    });
  });
});
</script>
</body>
</html>
